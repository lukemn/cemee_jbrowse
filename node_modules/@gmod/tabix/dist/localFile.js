'use strict';var _regenerator = require('babel-runtime/regenerator');var _regenerator2 = _interopRequireDefault(_regenerator);var _typeof2 = require('babel-runtime/helpers/typeof');var _typeof3 = _interopRequireDefault(_typeof2);var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);var _createClass2 = require('babel-runtime/helpers/createClass');var _createClass3 = _interopRequireDefault(_createClass2);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}var promisify = require('util.promisify');

// don't load fs native module if running in webpacked code
var fs = typeof __webpack_require__ !== 'function' ? require('fs') : null; // eslint-disable-line camelcase

var fsOpen = fs && promisify(fs.open);
var fsRead = fs && promisify(fs.read);
var fsFStat = fs && promisify(fs.fstat);
var fsReadFile = fs && promisify(fs.readFile);var

LocalFile = function () {
  function LocalFile(source) {(0, _classCallCheck3.default)(this, LocalFile);
    this.position = 0;
    this.filename = source;
    this.fd = fsOpen(this.filename, 'r');
  }(0, _createClass3.default)(LocalFile, [{ key: 'read', value: function () {var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(

      buffer) {var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;var length = arguments[2];var position = arguments[3];var readPosition, ret;return _regenerator2.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:
                readPosition = position;
                if (readPosition === null) {
                  readPosition = this.position;
                  this.position += length;
                }_context.t0 =
                fsRead;_context.next = 5;return this.fd;case 5:_context.t1 = _context.sent;_context.t2 = buffer;_context.t3 = offset;_context.t4 = length;_context.t5 = position;_context.next = 12;return (0, _context.t0)(_context.t1, _context.t2, _context.t3, _context.t4, _context.t5);case 12:ret = _context.sent;if (!(
                (typeof ret === 'undefined' ? 'undefined' : (0, _typeof3.default)(ret)) === 'object')) {_context.next = 15;break;}return _context.abrupt('return', ret.bytesRead);case 15:return _context.abrupt('return',
                ret);case 16:case 'end':return _context.stop();}}}, _callee, this);}));function read(_x2) {return _ref.apply(this, arguments);}return read;}() }, { key: 'readFile', value: function () {var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {return _regenerator2.default.wrap(function _callee2$(_context2) {while (1) {switch (_context2.prev = _context2.next) {case 0:return _context2.abrupt('return',



                fsReadFile(this.filename));case 1:case 'end':return _context2.stop();}}}, _callee2, this);}));function readFile() {return _ref2.apply(this, arguments);}return readFile;}() }, { key: 'stat', value: function () {var _ref3 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {return _regenerator2.default.wrap(function _callee3$(_context3) {while (1) {switch (_context3.prev = _context3.next) {case 0:if (



                this._stat) {_context3.next = 8;break;}_context3.t0 =
                fsFStat;_context3.next = 4;return this.fd;case 4:_context3.t1 = _context3.sent;_context3.next = 7;return (0, _context3.t0)(_context3.t1);case 7:this._stat = _context3.sent;case 8:return _context3.abrupt('return',

                this._stat);case 9:case 'end':return _context3.stop();}}}, _callee3, this);}));function stat() {return _ref3.apply(this, arguments);}return stat;}() }]);return LocalFile;}();



module.exports = LocalFile;